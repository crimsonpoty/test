#include <stdio.h>
#include <stdint.h>


/** Return CRC-8 of the data, using x^8 + x^2 + x + 1 polynomial. */
uint8_t Crc8(const uint8_t *vptr, int len)
{
	const uint8_t *data = vptr;
	uint16_t crc = 0;

	for (int j = len; j; j--, data++) {
		crc ^= (*data << 8);
		for(int i = 8; i; i--) {
			if (crc & 0x8000)
				crc ^= (0x1070 << 3);
			crc <<= 1;
		}
	}
	return (uint8_t)(crc >> 8);
}


int main()
{
	const uint8_t data[] = {
	0x02, 0xA6, 0x02, 0xCA, 0xA6, 0x24, 0x0A, 0xCE, 0x02,
	0xCA, 0xCE, 0x24, 0x12, 0xF6, 0x02, 0xCA, 0xF6, 0x24, 0x1B,
	0x1E, 0x02, 0xCB, 0x1E, 0x24, 0x23, 0x46, 0x02, 0xCB, 0x46,
	0x24, 0x2B, 0x6E, 0x02, 0xCB, 0x6E, 0x24, 0x34, 0x94, 0x02,
	0xCC, 0x94, 0x24, 0x3C, 0xBC, 0x02, 0xCC, 0xBC, 0x24, 0x44,
	0xE4, 0x02, 0xCC, 0xE4, 0x24, 0x4D, 0x0C, 0x02, 0xCD, 0x0C,
	0x24, 0x55, 0x34, 0x02, 0xCD, 0x34, 0x24, 0x5D, 0x5C, 0x02,
	0xCD, 0x5C, 0x24
	};
	
	printf("CRC-8(%02X)\n", Crc8(data, sizeof(data)));
	return 0;
}
